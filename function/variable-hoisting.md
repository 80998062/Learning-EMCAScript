## å˜é‡æå‡

[é—®é¢˜é“¾æ¥](http://stackoverflow.com/questions/3725546/variable-hoisting/3725763#3725763)

è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶,ä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¼šè¢«åˆ›å»º,å¯ä»¥è¢«åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µ:

* åˆ›å»ºé˜¶æ®µ:

åœ¨è¿™ä¸ªé˜¶æ®µä¸­ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡ä¼šåˆ†åˆ«**åˆ›å»ºå˜é‡å¯¹è±¡**ï¼Œ**å»ºç«‹ä½œç”¨åŸŸé“¾**ï¼Œä»¥åŠ**ç¡®å®šthisçš„æŒ‡å‘**

* ä»£ç æ‰§è¡Œé˜¶æ®µ:

åˆ›å»ºå®Œæˆä¹‹åï¼Œå°±ä¼šå¼€å§‹æ‰§è¡Œä»£ç ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¼šå®Œæˆå˜é‡èµ‹å€¼ï¼Œå‡½æ•°å¼•ç”¨ï¼Œä»¥åŠæ‰§è¡Œå…¶ä»–ä»£ç ã€‚



![](http://upload-images.jianshu.io/upload_images/599584-7d131cfe82a20d37.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)



å˜é‡å¯¹è±¡çš„åˆ›å»ºï¼Œä¾æ¬¡ç»å†äº†ä»¥ä¸‹å‡ ä¸ªè¿‡ç¨‹ã€‚

* **å»ºç«‹argumentså¯¹è±¡**ã€‚æ£€æŸ¥å½“å‰ä¸Šä¸‹æ–‡ä¸­çš„å‚æ•°ï¼Œå»ºç«‹è¯¥å¯¹è±¡ä¸‹çš„å±æ€§ä¸å±æ€§å€¼ã€‚

* æ£€æŸ¥å½“å‰ä¸Šä¸‹æ–‡çš„å‡½æ•°å£°æ˜ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨functionå…³é”®å­—å£°æ˜çš„å‡½æ•°ã€‚åœ¨å˜é‡å¯¹è±¡ä¸­ä»¥å‡½æ•°åå»ºç«‹ä¸€ä¸ªå±æ€§ï¼Œå±æ€§å€¼ä¸ºæŒ‡å‘è¯¥å‡½æ•°æ‰€åœ¨å†…å­˜åœ°å€çš„å¼•ç”¨ã€‚**å¦‚æœå‡½æ•°åçš„å±æ€§å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆè¯¥å±æ€§å°†ä¼šè¢«æ–°çš„å¼•ç”¨æ‰€è¦†ç›–ã€‚**
* æ£€æŸ¥å½“å‰ä¸Šä¸‹æ–‡ä¸­çš„å˜é‡å£°æ˜ï¼Œæ¯æ‰¾åˆ°ä¸€ä¸ªå˜é‡å£°æ˜ï¼Œå°±åœ¨å˜é‡å¯¹è±¡ä¸­ä»¥å˜é‡åå»ºç«‹ä¸€ä¸ªå±æ€§ï¼Œå±æ€§å€¼ä¸ºundefinedã€‚**å¦‚æœè¯¥å˜é‡åçš„å±æ€§å·²ç»å­˜åœ¨ï¼Œä¸ºäº†é˜²æ­¢åŒåçš„å‡½æ•°è¢«ä¿®æ”¹ä¸ºundefinedï¼Œåˆ™ä¼šç›´æ¥è·³è¿‡ï¼ŒåŸå±æ€§å€¼ä¸ä¼šè¢«ä¿®æ”¹**ã€‚

ä¸¾ä¸ªğŸŒ°:

```js
function test() {
    var foo;

    foo = 20;

    console.log(foo);

    function foo() {

    }

    console.log(foo);

}

test();
```

è¿™ä¸ªæ—¶å€™è¾“å‡ºçš„ç»“æœæ˜¯ **20,20**

é‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥è¿™ä¹ˆè®¤ä¸º:`function foo() {}`ç›¸å½“äº`var foo ,`

éƒ½æ˜¯å£°æ˜,å£°æ˜åœ¨å˜é‡å·²ç»è¢«èµ‹å€¼çš„æƒ…å†µä¸‹ä¼šè¢«è·³è¿‡

**ç„¶è€Œèµ‹å€¼å¯ä»¥è¦†ç›–:**

```js
function test() {
    var foo;

    foo = 20;

    console.log(foo);

    foo = function () {

    }

    console.log(foo);
}

test();
```

è¾“å‡ºç»“æœ:

```js
20
[Function: foo]
```

ç„¶åç»“åˆè¿™ä¸ªå¯ä»¥çœ‹å‡º:

```js
function test() {
    function foo() {

    }
    
    var foo;
    
    console.log(foo);

    foo = 20;

    console.log(foo);
}

test();

// è¾“å‡º:
// [Function: foo]
// 20
```

è¿™æ ·å¯ä»¥çœ‹å‡º,åŒæ ·æ˜¯å£°æ˜,`Function`çš„ä¼˜å…ˆçº§è¦é«˜äº`undefined`

> å‰ææ˜¯åœ¨å˜é‡åˆ›å»ºé˜¶æ®µ



æœªè¿›å…¥æ‰§è¡Œé˜¶æ®µä¹‹å‰ï¼Œå˜é‡å¯¹è±¡ä¸­çš„å±æ€§éƒ½ä¸èƒ½è®¿é—®ï¼ä½†æ˜¯è¿›å…¥æ‰§è¡Œé˜¶æ®µä¹‹åï¼Œå˜é‡å¯¹è±¡è½¬å˜ä¸ºäº†æ´»åŠ¨å¯¹è±¡ï¼Œé‡Œé¢çš„å±æ€§éƒ½èƒ½è¢«è®¿é—®äº†ï¼Œç„¶åå¼€å§‹è¿›è¡Œæ‰§è¡Œé˜¶æ®µçš„æ“ä½œã€‚

```js
// åˆ›å»ºè¿‡ç¨‹
testEC = {
    // å˜é‡å¯¹è±¡
    VO: {},
    scopeChain: {},
    this: {}
}

// å› ä¸ºæœ¬æ–‡æš‚æ—¶ä¸è¯¦ç»†è§£é‡Šä½œç”¨åŸŸé“¾å’Œthisï¼Œæ‰€ä»¥æŠŠå˜é‡å¯¹è±¡ä¸“é—¨æå‡ºæ¥è¯´æ˜

// VO ä¸º Variable Objectçš„ç¼©å†™ï¼Œå³å˜é‡å¯¹è±¡
VO = {
    arguments: {...},
    foo: <foo reference>  // è¡¨ç¤ºfooçš„åœ°å€å¼•ç”¨
    a: undefined
}
```



ä¸¾ä¸ªğŸŒ°:

```js
function test() {
    console.log(foo);
    console.log(bar);

    var foo = 'Hello';
    console.log(foo);
    var bar = function () {
        return 'world';
    }

    function foo() {
        return 'hello';
    }
}

test();
```

**Alternatively:**

```js
function test() {
    var foo;
    var bar;
    function foo() {
        return 'hello';
    }
    console.log(foo);
    console.log(bar);

    foo = 'Hello';
    console.log(foo);
    bar = function () {
        return 'world';
    }   
}

test();
```



```js

function test() {
    var foo;

    foo = 20;

    function foo() {

    }

    var foo;

    console.log(foo);
}

test(); // è¾“å‡º20
```

ç”±ä¸Šå›¾å¯ä»¥çœ‹åˆ°,å½“ä¸€ä¸ªå˜é‡å·²ç»è¢«èµ‹å€¼çš„æ—¶å€™,å†æ¬¡å£°æ˜å®ƒå°†ä¼šè¢«è·³è¿‡

è€Œ`function foo() `ä¹Ÿæ˜¯ä¸€ä¸ªå£°æ˜

è€Œå¦‚æœæ²¡æœ‰è¢«èµ‹å€¼,å†æ¬¡å£°æ˜å°±æ˜¯æœ‰æ•ˆçš„

ä¸¾ä¸ªğŸŒ°:

```js
function test() {
    var foo;
    
    function foo() {

    }

    console.log(foo);
}

test();  // è¾“å‡º[Function: foo]
```

## å…¨å±€ä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡

ä»¥æµè§ˆå™¨ä¸­ä¸ºä¾‹ï¼Œå…¨å±€å¯¹è±¡ä¸º`window`ã€‚  


